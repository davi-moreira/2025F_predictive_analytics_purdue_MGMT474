<!DOCTYPE html>
<html lang="en"><head>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.32">

  <meta name="author" content="Professor: Davi Moreira">
  <title>MGMT 47400: Predictive Analytics –  MGMT 47400: Predictive Analytics </title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-c812a774c17cd743a31b19f8745c44ab.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title"><span style="font-size: 100%;"> MGMT 47400: Predictive Analytics </span></h1>
  <p class="subtitle"><span style="font-size: 150%;"> Beyond Linearity </span></p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Professor: Davi Moreira 
</div>
</div>
</div>

</section>
<section id="overview" class="slide level2 center">
<h2>Overview</h2>
<div class="columns">
<div class="column" style="text-align: center; justify-content: center; align-items: center;">
<ul>
<li>Moving Beyond Linearity</li>
<li>Polynomial Regression</li>
<li>Step Functions</li>
<li>Regression Splines</li>
</ul>
</div><div class="column" style="text-align: center; justify-content: center; align-items: center;">
<ul>
<li>Smoothing Splines</li>
<li>Local Regression</li>
<li>Generalized Additive Models</li>
</ul>
</div></div>
<p><br></p>

<aside><div>
<p><em>This lecture content is inspired by and replicates the material from <a href="https://www.statlearning.com/">An Introduction to Statistical Learning</a>.</em></p>
</div></aside></section>
<section>
<section id="moving-beyond-linearity" class="title-slide slide level1 center" data-background-color="#cfb991">
<h1>Moving Beyond Linearity</h1>

</section>
<section id="moving-beyond-linearity-1" class="slide level2 center">
<h2>Moving Beyond Linearity</h2>
<ul>
<li class="fragment"><p>The truth is never linear!</p></li>
<li class="fragment"><p>Or almost never!</p></li>
<li class="fragment"><p>But often the linearity assumption is good enough.</p></li>
<li class="fragment"><p>When it’s not…</p>
<ul>
<li class="fragment">polynomials,<br>
</li>
<li class="fragment">step functions,<br>
</li>
<li class="fragment">splines,<br>
</li>
<li class="fragment">local regression, and<br>
</li>
<li class="fragment">generalized additive models</li>
</ul></li>
<li class="fragment"><p>offer a lot of flexibility, without losing the ease and interpretability of linear models.</p></li>
</ul>
</section></section>
<section>
<section id="polynomial-regression" class="title-slide slide level1 center" data-background-color="#cfb991">
<h1>Polynomial Regression</h1>

</section>
<section id="polynomial-regression-wage-data" class="slide level2 center">
<h2>Polynomial Regression: Wage Data</h2>
<div style="font-size: 70%;">
<p>Polynomial regression extends the linear model by adding extra predictors, obtained by raising each of the original predictors to a power. It provides a simple way to provide a non-linear fit to data.</p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1 x_i + \beta_2 x_i^2 + \beta_3 x_i^3 + \dots + \beta_d x_i^d + \epsilon_i
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/7_1-1.png" class="quarto-figure quarto-figure-center" style="width:45.0%"></p>
</figure>
</div>
</div>
</div>
<div class="columns">
<div class="column" style="text-align: center; justify-content: center; align-items: center;">
<ul>
<li class="fragment"><strong>Left Plot</strong>: We fit a fourth-degree polynomial model to predict Wage using Age as the predictor. The data become sparse toward the higher end of Age, so there is relatively little information to guide the model’s fit in that region. As a result, the standard errors increase toward the tail—a phenomenon often referred to as “leverage.”</li>
</ul>
</div><div class="column" style="text-align: center; justify-content: center; align-items: center;">
<ul>
<li class="fragment"><strong>Right Plot</strong>: We fit a fourth-degree polynomial model for a logistic regression. Similar to the left plot, the data diminish at the tail end of the predictor range, leaving fewer observations to inform the fit and leading to wider confidence intervals in that region.</li>
</ul>
</div></div>
</div>
</section>
<section id="polynomial-regression-details" class="slide level2 center">
<h2>Polynomial Regression: Details</h2>
<div style="font-size: 80%;">
<ul>
<li class="fragment"><p>Create new variables <span class="math inline">\(X_1 = X, \, X_2 = X^2\)</span>, etc., and then treat as multiple linear regression.</p></li>
<li class="fragment"><p>It is linear in the coefficients, but it is a non linear function of <span class="math inline">\(x\)</span>.</p></li>
<li class="fragment"><p>Not really interested in the coefficients; more interested in the fitted function values at any value <span class="math inline">\(x_0\)</span>:</p></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
    \hat{f}(x_0) = \hat{\beta}_0 + \hat{\beta}_1 x_0 + \hat{\beta}_2 x_0^2 + \hat{\beta}_3 x_0^3 + \hat{\beta}_4 x_0^4.
\]</span></p>
</div>
<ul>
<li class="fragment"><p>Since <span class="math inline">\(\hat{f}(x_0)\)</span> is a linear function of the <span class="math inline">\(\hat{\beta}_\ell\)</span>, can get a simple expression for <em>pointwise-variances</em> (<span class="math inline">\(\text{Var}[\hat{f}(x_0)]\)</span>) at any value <span class="math inline">\(x_0\)</span>.</p>
<ul>
<li class="fragment">In the figure, we have computed the fit and pointwise standard errors on a grid of values for <span class="math inline">\(x_0\)</span>. We show <span class="math inline">\(\hat{f}(x_0) \pm 2 \cdot \text{se}[\hat{f}(x_0)]\)</span>.</li>
</ul></li>
<li class="fragment"><p>How to choose <span class="math inline">\(d\)</span>, the polinomial degree? We either fix the degree <span class="math inline">\(d\)</span> at some reasonably low value or use cross-validation to choose <span class="math inline">\(d\)</span>.</p></li>
</ul>
</div>
</section>
<section id="polynomial-regression-details-1" class="slide level2 center">
<h2>Polynomial Regression: Details</h2>
<div style="font-size: 80%;">
<ul>
<li class="fragment">Logistic regression follows naturally. For example, in the figure we model</li>
</ul>
<div class="fragment">
<p><span class="math display">\[
    \text{Pr}(y_i &gt; 250 \mid x_i) = \frac{\exp(\beta_0 + \beta_1 x_i + \beta_2 x_i^2 + \dots + \beta_d x_i^d)}{1 + \exp(\beta_0 + \beta_1 x_i + \beta_2 x_i^2 + \dots + \beta_d x_i^d)}.
\]</span></p>
</div>
<ul>
<li class="fragment"><p>To get confidence intervals, compute upper and lower bounds on <em>on the logit scale</em>, and then invert to get on the probability scale.</p></li>
<li class="fragment"><p>Can do separately on several variables—just stack the variables into one matrix, and separate out the pieces afterwards (see GAMs later).</p></li>
<li class="fragment"><p><strong>Caveat</strong>: Polynomials have notorious tail behavior — very bad for extrapolation. So, it is not recommended to trust predictions near the end of the data.</p></li>
</ul>
</div>
</section></section>
<section>
<section id="step-functions" class="title-slide slide level1 center" data-background-color="#cfb991">
<h1>Step Functions</h1>

</section>
<section id="step-functions-1" class="slide level2 center">
<h2>Step Functions</h2>
<div style="font-size: 70%;">
<p>Step functions cut the range of a variable into <span class="math inline">\(K\)</span> distinct regions in order to produce a qualitative variable. This has the effect of fitting a piecewise constant function.</p>
<p><span class="math display">\[
C_1(X) = I(X &lt; 35), \quad C_2(X) = I(35 \leq X &lt; 50), \dots, C_3(X) = I(X \geq 65)
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/7_2-1.png" class="quarto-figure quarto-figure-center" style="width:65.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="step-functions-2" class="slide level2 center">
<h2>Step Functions</h2>
<div style="font-size: 75%;">
<p>A step function model partitions the range of a predictor variable <span class="math inline">\(X\)</span> into multiple intervals and creates a set of dummy (0/1) indicators—one for each interval. By fitting a standard linear model with these dummy variables, the resulting function is piecewise constant: within each interval, the fitted value remains the same.</p>
<ul>
<li class="fragment"><p><strong>Local (Step Functions)</strong>: Because each interval in a step function acts independently, changes in one interval have minimal or no effect on the fitted values in other intervals. Consequently, step functions allow a locally controlled fit, where data in a specific region of <span class="math inline">\(X\)</span> only affect the parameters corresponding to that interval.</p></li>
<li class="fragment"><p><strong>Global (Polynomials)</strong>: In contrast, polynomial models rely on parameters that apply across the entire range of <span class="math inline">\(X\)</span>. Consequently, if you alter a single data point or a small set of points in one region, those changes can influence the fitted function everywhere else. This global dependence can lead to dramatic shifts in the estimated curve.</p></li>
<li class="fragment"><p><strong>Simplicity</strong>: Step functions are conceptually straightforward and easy to implement, requiring only the definition of intervals and fitting dummy variables.</p></li>
<li class="fragment"><p><strong>Local Control</strong>: Their piecewise nature can be beneficial when the true relationship changes abruptly or when you want to minimize the effect of outliers in one region on the fit elsewhere.</p></li>
<li class="fragment"><p>But there are some Drawbacks:</p>
<ul>
<li class="fragment"><strong>Blocky Appearance</strong>: The fitted function may appear abrupt or “blocky,” as it is piecewise constant rather than smooth.<br>
</li>
<li class="fragment"><strong>Boundary Sensitivity</strong>: Choosing the number and location of breakpoints is somewhat subjective and can significantly impact the model’s fit.</li>
</ul></li>
<li class="fragment"><p>Overall, step functions provide an intuitive, locally controlled alternative to global polynomial models. However, the abrupt transitions and the need to specify breakpoints can limit their practical appeal—particularly for applications where a smooth or continuous functional form is desired.</p></li>
</ul>
<!---
you create a bunch of dummy variables, zero/one variables, and you just fit those with a linear model. The advantage this has over over polynomials is that it \is local, while polynomials it's a single function for the whole range of the of the x variable. So for example if i change a point on the left side it could potentially change the fit on the right side quite a bit for polynomials. For step functions a fit a point only affects the the fit in in the partition it's sitting in and not the other partitions. The polynomial parameters affect the function everywhere and and can have dramatic effects here we've done the same thing as we did before for the logistic regression but with a piecewise constant function everything else is the same but the fitted function is kind of blocky and you know maybe considered not as attractive step functions are easy to work with.
--->
</div>
</section>
<section id="step-functions-3" class="slide level2 center">
<h2>Step functions</h2>
<ul>
<li class="fragment"><p>Easy to work with. Creates a series of dummy variables representing each group.</p></li>
<li class="fragment"><p>Useful way of creating interactions that are easy to interpret. For example, interaction effect of <span class="math inline">\(\text{Year}\)</span> and <span class="math inline">\(\text{Age}\)</span>:</p></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
    I(\text{Year} &lt; 2005) \cdot \text{Age}, \quad I(\text{Year} \geq 2005) \cdot \text{Age}
\]</span></p>
<p>would allow for different linear functions in each age category.</p>
</div>
<ul>
<li class="fragment">Choice of cutpoints or <em>knots</em> can be problematic. For creating nonlinearities, smoother alternatives such as <em>splines</em> are available.</li>
</ul>
</section>
<section id="summary" class="slide level2 center">
<h2>Summary</h2>
<div style="font-size: 75%;">
<p>While linear models are simple and often effective, real-world data frequently exhibit non-linear relationships, necessitating more flexible modeling approaches.</p>
<ul>
<li class="fragment"><strong>Non-Linearity is Common</strong>: Most real-world data are not well-represented by simple linear trends, underscoring the importance of non-linear modeling techniques.<br>
</li>
<li class="fragment"><strong>Polynomial Regression</strong>: Extends linear models by including polynomial terms, enabling the capture of curved relationships. This method offers flexibility but may exhibit instability, especially at the tails, where standard error bands tend to widen due to sparse data.<br>
</li>
<li class="fragment"><strong>Step Functions</strong>: Provide an alternative approach by dividing continuous variables into discrete intervals, resulting in piecewise constant fits. This makes them particularly useful when natural breakpoints exist in the data.<br>
</li>
<li class="fragment"><strong>Interactions with Dummy Variables</strong>: Step functions are intuitive to work with and allow for straightforward inclusion of interaction effects through the creation of dummy variables.<br>
</li>
<li class="fragment"><strong>Challenges of Step Functions</strong>: The performance of step functions heavily depends on the selection of cut points. Poorly chosen boundaries can obscure important patterns or lead to overfitting, highlighting the need for domain expertise when applying this method.<br>
</li>
<li class="fragment"><strong>Takeaway</strong>: Both polynomial regression and step functions are valuable tools for modeling non-linear relationships. However, their effectiveness depends on thoughtful implementation, particularly in managing standard errors and selecting appropriate cut points.</li>
</ul>
</div>
</section></section>
<section>
<section id="regression-splines" class="title-slide slide level1 center" data-background-color="#cfb991">
<h1>Regression Splines</h1>

</section>
<section id="regression-splines-1" class="slide level2 center">
<h2>Regression Splines</h2>
<ul>
<li class="fragment"><p>Regression splines are an extension and more flexible than polynomials and step functions.</p></li>
<li class="fragment"><p>They involve dividing the range of <span class="math inline">\(X\)</span> into <span class="math inline">\(K\)</span> distinct regions. Within each region, a polynomial function is fit to the data.</p></li>
<li class="fragment"><p>However, these polynomials are constrained so that they join smoothly at the region boundaries, or knots. Provided that the interval is divided into enough regions, this can produce an extremely flexible fit.</p></li>
</ul>
</section>
<section id="piecewise-polynomials" class="slide level2 center">
<h2>Piecewise Polynomials</h2>
<ul>
<li class="fragment">Instead of a single polynomial in <span class="math inline">\(X\)</span> over its whole domain, we can rather use different polynomials in regions defined by knots.</li>
</ul>
<div class="fragment">
<p><span class="math display">\[
    y_i =
    \begin{cases}
    \beta_{01} + \beta_{11}x_i + \beta_{21}x_i^2 + \beta_{31}x_i^3 + \epsilon_i &amp; \text{if } x_i &lt; c; \\
    \beta_{02} + \beta_{12}x_i + \beta_{22}x_i^2 + \beta_{32}x_i^3 + \epsilon_i &amp; \text{if } x_i \geq c.
    \end{cases}
\]</span></p>
</div>
<ul>
<li class="fragment"><p>Better to add constraints to the polynomials, e.g., continuity.</p></li>
<li class="fragment"><p><em>Splines</em> have the “maximum” amount of continuity.</p></li>
</ul>
</section>
<section id="splines-visualization" class="slide level2 center">
<h2>Splines Visualization</h2>
<div style="font-size: 60%;">
<div class="columns">
<div class="column" style="text-align: center; justify-content: center; align-items: center;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/7_3-1.png" class="quarto-figure quarto-figure-center" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="text-align: center; justify-content: center; align-items: center;">
<ul>
<li class="fragment"><p><strong>Top-Left Panel</strong>: A third-degree polynomial is fitted to the data on the left side of the knot at <span class="math inline">\(X = 50\)</span>, and another (separate) third-degree polynomial is fitted on the right side. There is no continuity constraint imposed at the knot, meaning the two polynomials may not meet at the same function value at <span class="math inline">\(X = 50\)</span>.</p></li>
<li class="fragment"><p><strong>Top-Right Panel</strong>: Again, a third-degree polynomial is fitted on each side of <span class="math inline">\(X = 50\)</span>. However, in this case, the polynomials are forced to be continuous at the knot. In other words, they must share the same function value at <span class="math inline">\(X = 50\)</span>.</p></li>
<li class="fragment"><p><strong>Bottom-Left Panel</strong>: As in the top-right panel, a third-degree polynomial is fitted on each side of <span class="math inline">\(X = 50\)</span>, but with an additional constraint that enforces continuity of the first and second derivatives at <span class="math inline">\(X = 50\)</span>. This ensures a smoother transition between the left and right segments of the piecewise function.</p></li>
<li class="fragment"><p><strong>Bottom-Right Panel</strong>: A linear regression model is fitted on each side of <span class="math inline">\(X = 50\)</span>. The model is constrained to be continuous at the knot, so both linear segments meet at the same value at <span class="math inline">\(X = 50\)</span>.</p></li>
</ul>
</div></div>
</div>
</section>
<section id="linear-splines" class="slide level2 center">
<h2>Linear Splines</h2>
<div style="font-size: 70%;">
<p>The predictor space is partitioned at a set of specified points called <strong>knots</strong> <span class="math inline">\(\{\xi_k\}\)</span>. A linear spline is a <strong>piecewise linear polynomial</strong> that remains <strong>continuous</strong> at each knot.</p>
<p>We construct <strong>linear spline models</strong> by augmenting a linear predictor with piecewise components that activate past designated knot locations, yielding a flexible yet interpretable approach to modeling relationships. Specifically:</p>
<div class="columns">
<div class="column" style="justify-content: center; align-items: center;">
<ol type="1">
<li class="fragment"><strong>Basis-Function Representation</strong>: The model is written as</li>
</ol>
<div class="fragment">
<p><span class="math display">\[
   y_i = \beta_0 + \beta_1 b_1(x_i) + \beta_2 b_2(x_i) + \cdots + \beta_{K+1} b_{K+1}(x_i) + \epsilon_i,
\]</span></p>
<p>where each <span class="math inline">\(b_k(\cdot)\)</span> is a <em>basis function</em>.</p>
<p>One basis function, <span class="math inline">\(b_1(x_i)\)</span>, is simply <span class="math inline">\(x_i\)</span>. The others, <span class="math inline">\(b_{k+1}(x_i) = (x_i - \xi_k)_+\)</span>, capture <strong>local deviations</strong> after each knot <span class="math inline">\(\xi_k\)</span>.</p>
<p>The notation <span class="math inline">\((\cdot)_+\)</span> denotes the “positive part,” meaning <span class="math inline">\(\max\{0, \cdot\}\)</span>. Therefore, <span class="math inline">\((x_i - \xi_k)_+ = x_i - \xi_k\)</span> if <span class="math inline">\(x_i &gt; \xi_k\)</span>, and 0 otherwise.</p>
</div>
<ol start="2" type="1">
<li class="fragment"><strong>Piecewise Linear Behavior</strong>: Because <span class="math inline">\(b_{k+1}(x_i)\)</span> only becomes non-zero when <span class="math inline">\(x_i\)</span> exceeds the knot <span class="math inline">\(\xi_k\)</span>, the spline behaves like a linear function with <em>additional slopes</em> kicking in after each knot.</li>
</ol>
<div class="fragment">
<p>Essentially, below the smallest knot, the model is a simple linear function of <span class="math inline">\(x_i\)</span>. Once <span class="math inline">\(x_i\)</span> passes a knot <span class="math inline">\(\xi_k\)</span>, the corresponding term <span class="math inline">\((x_i - \xi_k)_+\)</span> begins to contribute, allowing the slope to change. This creates <strong>segments</strong> of potentially different slopes while maintaining continuity at the knots.</p>
</div>
</div><div class="column" style="justify-content: center; align-items: center;">
<ol start="3" type="1">
<li class="fragment"><p><strong>Continuity at Knots</strong>: Despite having distinct linear segments, the spline remains <strong>continuous</strong> at each <span class="math inline">\(\xi_k\)</span>. The continuity follows naturally from how <span class="math inline">\((\cdot)_+\)</span> is defined. At a knot, <span class="math inline">\((x_i - \xi_k)_+\)</span> transitions from 0 to a linear increase, ensuring no jumps in the fitted function.</p></li>
<li class="fragment"><p><strong>Relevance</strong></p></li>
</ol>
<ul>
<li class="fragment"><p><strong>Flexibility</strong>: Linear splines allow for <strong>piecewise changes</strong> in slope rather than forcing a single global linear relationship. This can capture more nuanced relationships between predictors and responses.</p></li>
<li class="fragment"><p><strong>Interpretability</strong>: Each knot <span class="math inline">\(\xi_k\)</span> marks a point where the slope can adjust, making it straightforward to interpret how the effect of <span class="math inline">\(x_i\)</span> differs below and above that knot.</p></li>
<li class="fragment"><p><strong>Comparison to Polynomials</strong>: Unlike higher-order polynomials, splines can avoid the global distortion that arises from polynomial terms. A single outlier or a data pattern in one region does not overly influence the fit across the entire range of <span class="math inline">\(x\)</span>.</p></li>
</ul>
</div></div>
</div>
</section>
<section id="lienar-splines-example" class="slide level2 center">
<h2>Lienar Splines: Example</h2>
<div style="font-size: 70%;">
<p>To illustrate a linear spline with <strong>one knot</strong> at <span class="math inline">\(x = 50\)</span>, suppose we have a response variable <span class="math inline">\(y\)</span> (e.g., a person’s yearly wage) and a single predictor <span class="math inline">\(x\)</span> (e.g., age):</p>
<div class="columns">
<div class="column" style="justify-content: center; align-items: center;">
<ol type="1">
<li class="fragment"><strong>Define the Basis Functions</strong>: We choose to place a <strong>single knot</strong> at <span class="math inline">\(x = 50\)</span>. According to the slide’s notation, the basis functions are:</li>
</ol>
<div class="fragment">
<p><span class="math display">\[
   b_1(x_i) = x_i, \quad
   b_2(x_i) = (x_i - 50)_{+} \,=\,
   \begin{cases}
     x_i - 50, &amp; \text{if } x_i &gt; 50,\\
     0, &amp; \text{if } x_i \le 50.
   \end{cases}
\]</span></p>
</div>
<ol start="2" type="1">
<li class="fragment"><strong>Specify the Model</strong>: The corresponding linear spline model is:</li>
</ol>
<div class="fragment">
<p><span class="math display">\[
   y_i = \beta_0 + \beta_1 \, b_1(x_i) + \beta_2 \, b_2(x_i) + \epsilon_i,
\]</span></p>
</div>
<ul>
<li class="fragment">or more explicitly:</li>
</ul>
<div class="fragment">
<p><span class="math display">\[
   y_i = \beta_0 + \beta_1 \, x_i + \beta_2 \, (x_i - 50)_{+} + \epsilon_i.
\]</span></p>
</div>
</div><div class="column" style="justify-content: center; align-items: center;">
<div class="fragment">
<p>3.<strong>For</strong> <span class="math inline">\(x_i \le 50\)</span>:</p>
</div>
<ul>
<li class="fragment"><span class="math inline">\((x_i - 50)_+ = 0\)</span>. Hence, the model reduces to</li>
</ul>
<div class="fragment">
<p><span class="math display">\[
     y_i = \beta_0 + \beta_1 x_i + \epsilon_i
\]</span></p>
</div>
<ul>
<li class="fragment">which is a simple linear relationship with slope <span class="math inline">\(\beta_1\)</span> for <strong>ages up to 50</strong>.</li>
</ul>
<div class="fragment">
<p>4.<strong>For</strong> <span class="math inline">\(x_i &gt; 50\)</span>:</p>
</div>
<ul>
<li class="fragment"><span class="math inline">\((x_i - 50)_+ = x_i - 50\)</span>. Thus, the model becomes</li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\begin{aligned}
y_i &amp;= \beta_0 + \beta_1 x_i + \beta_2 (x_i - 50) + \epsilon_i \\
    &amp;= [\beta_0 - 50 \beta_2] + (\beta_1 + \beta_2) x_i + \epsilon_i
\end{aligned}
\]</span></p>
</div>
<ul>
<li class="fragment">meaning the slope for <strong>ages beyond 50</strong> is <span class="math inline">\(\beta_1 + \beta_2\)</span>. The intercept adjusts accordingly to ensure the function remains continuous at <span class="math inline">\(x=50\)</span>.</li>
</ul>
<!---
## Linear Splines

*A linear spline with knots at* $\xi_k, \, k = 1, \dots, K$ *is a piecewise linear polynomial continuous at each knot.*

We can represent this model as

$$
y_i = \beta_0 + \beta_1 b_1(x_i) + \beta_2 b_2(x_i) + \cdots + \beta_{K+1} b_{K+1}(x_i) + \epsilon_i,
$$

where the $b_k$ are *basis functions*.

$$
b_1(x_i) = x_i
$$

$$
b_{k+1}(x_i) = (x_i - \xi_k)_+, \quad k = 1, \dots, K
$$

Here the $()_+$ means *positive part*; i.e.,

$$
(x_i - \xi_k)_+ =
\begin{cases}
x_i - \xi_k & \text{if } x_i > \xi_k \\
0 & \text{otherwise}
\end{cases}
$$

--->
</div></div>
<ul>
<li class="fragment"><p><strong>Local Flexibility</strong>: Below 50, the effect of age on wage is governed by <span class="math inline">\(\beta_1\)</span>. Above 50, the slope can change to <span class="math inline">\(\beta_1 + \beta_2\)</span>.</p></li>
<li class="fragment"><p><strong>Continuity at 50</strong>: Because the spline is forced to match up at <span class="math inline">\(x = 50\)</span>, there is no abrupt jump in the fitted curve.</p></li>
<li class="fragment"><p><strong>Simplicity of Implementation</strong>: We only introduced one additional term <span class="math inline">\((x_i - 50)_+\)</span> to capture the potential change in slope after age 50.</p></li>
</ul>
</div>
</section>
<section id="linear-splines-visualization" class="slide level2 center">
<h2>Linear Splines Visualization</h2>
<div style="font-size: 65%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/7_1_1-1.png" class="quarto-figure quarto-figure-center" style="width:45.0%"></p>
</figure>
</div>
</div>
</div>
<ul>
<li class="fragment"><p><strong>Top plot</strong>: shows two linear fits over the domain <span class="math inline">\(0 \le x \le 1\)</span>. The blue line represents a <em>single global</em> linear function (extending as the dashed line beyond the knot at <span class="math inline">\(x = 0.6\)</span>), whereas the orange line demonstrates how <em>adding</em> a spline basis function allows the slope to change precisely at <span class="math inline">\(x = 0.6\)</span>.</p></li>
<li class="fragment"><p><strong>Bottom plot</strong>: displays the corresponding basis function <span class="math inline">\(b(x) = (x - 0.6)_{+}\)</span>, which is defined to be zero for <span class="math inline">\(x \le 0.6\)</span> and increases linearly for <span class="math inline">\(x &gt; 0.6\)</span>. Because <span class="math inline">\(b(x)\)</span> starts at zero at the knot, it does not introduce a jump—thus ensuring <em>continuity</em>—but it permits the slope to differ on either side of <span class="math inline">\(x = 0.6\)</span>.</p>
<ul>
<li class="fragment">By including this basis function (and a coefficient for it) in a linear model, one can capture a “bend” or change in slope at the specified knot. More generally, introducing additional such functions at different knots yields a piecewise linear model that remains continuous but adapts its slope in each region.</li>
</ul></li>
</ul>
<!---
the blue curve is a is a just a global linear function. yes we've only got one not here so here's one of these basis functions see it starts off at zero at the knot and then it goes up linearly so this is is x minus 0.6 positive part below 0.6 it's zero so now when you fit a linear model with with a global linear function plus one of these in and each of them gets a coefficient what you get is you get a function that's allowed to change its slope at the knot so if you add in some mix of this to a linear function it'll change the slope of this point and so here we see it over here okay and because this starts off at zero it makes sure it's continuous here very handy and you can make a bunch of these functions for however many knots 

--->
</div>
</section>
<section id="cubic-splines" class="slide level2 center">
<h2>Cubic Splines</h2>
<div style="font-size: 80%;">
<p><em>A cubic spline with knots at</em> <span class="math inline">\(\xi_k, \, k = 1, \dots, K\)</span> <em>is a piecewise cubic polynomial with continuous derivatives up to order 2 at each knot.</em></p>
<p>Again we can represent this model with truncated power basis functions:</p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1 b_1(x_i) + \beta_2 b_2(x_i) + \cdots + \beta_{K+3} b_{K+3}(x_i) + \epsilon_i,
\]</span></p>
<p><span class="math inline">\(b_1(x_i) = x_i,\)</span></p>
<p><span class="math inline">\(b_2(x_i) = x_i^2,\)</span></p>
<p><span class="math inline">\(b_3(x_i) = x_i^3,\)</span></p>
<p><span class="math inline">\(b_{k+3}(x_i) = (x_i - \xi_k)_+^3, \quad k = 1, \dots, K\)</span></p>
<p><br></p>
<p>where</p>
<p><span class="math display">\[
(x_i - \xi_k)_+^3 =
\begin{cases}
(x_i - \xi_k)^3 &amp; \text{if } x_i &gt; \xi_k, \\
0 &amp; \text{otherwise}.
\end{cases}
\]</span></p>
</div>
</section>
<section id="cubic-splines-visualization" class="slide level2 center">
<h2>Cubic Splines Visualization</h2>

<img data-src="figs/7_1_2-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:65.0%"></section>
<section id="natural-cubic-splines" class="slide level2 center">
<h2>Natural Cubic Splines</h2>
<p>A natural cubic spline extrapolates linearly beyond the boundary knots. This adds <span class="math inline">\(4 = 2 \times 2\)</span> extra constraints, and allows us to put more internal knots for the same degrees of freedom as a regular cubic spline.</p>

<img data-src="figs/7_4-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:65.0%"></section>
<section id="natural-cubic-spline" class="slide level2 center">
<h2>Natural Cubic Spline</h2>

<img data-src="figs/7_5-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:65.0%"></section>
<section id="knot-placement" class="slide level2 center">
<h2>Knot Placement</h2>
<div style="font-size: 70%;">
<ul>
<li class="fragment"><p>One strategy is to decide <span class="math inline">\(K\)</span>, the number of knots, and then place them at appropriate quantiles of the observed <span class="math inline">\(X\)</span>.</p></li>
<li class="fragment"><p>A cubic spline with <span class="math inline">\(K\)</span> knots has <span class="math inline">\(K + 4\)</span> parameters or degrees of freedom.</p></li>
<li class="fragment"><p>A natural spline with <span class="math inline">\(K\)</span> knots has <span class="math inline">\(K\)</span> degrees of freedom.</p></li>
</ul>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/7_7-1.png" class="quarto-figure quarto-figure-center" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<ul>
<li class="fragment"><strong>Figure</strong>: Comparison of a degree-14 polynomial and a natural cubic spline, each with 15df.</li>
</ul>
<p><br></p>
</div>
</section>
<section id="summary-1" class="slide level2 center">
<h2>Summary</h2>
<div style="font-size: 70%;">
<p>Splines and piecewise polynomials build on the concept of dividing the predictor domain into segments, offering enhanced flexibility and precision over traditional polynomial models. By using different polynomial functions in various regions and ensuring smooth transitions at knots, these methods provide a powerful approach to capturing non-linear relationships in data.</p>
<ul>
<li class="fragment"><p><strong>Piecewise Polynomials</strong>: Replace a single global polynomial with multiple polynomials fitted across segments, resulting in a more tailored and adaptable fit.<br>
</p></li>
<li class="fragment"><p><strong>Continuity Constraints</strong>: Enforcing continuity at knots ensures smooth transitions between polynomial segments, avoiding abrupt changes and better representing underlying trends.<br>
</p></li>
<li class="fragment"><p><strong>Natural Cubic Splines</strong>: Add further constraints by requiring smoothness in the function’s second derivative at knots and controlling boundary behavior, ensuring robustness and reducing overfitting at extremes.<br>
</p></li>
<li class="fragment"><p><strong>Flexibility and Local Adaptation</strong>: Piecewise polynomials adapt to local data behavior, making them particularly effective for capturing non-linear trends and abrupt changes in data. This adaptability is essential in real-world datasets that exhibit complex patterns.<br>
</p></li>
<li class="fragment"><p><strong>Strategic Knot Placement</strong>: Properly placing knots, such as at quantiles of the predictor variable, ensures that each segment has adequate data coverage, resulting in more reliable and stable estimates.<br>
</p></li>
<li class="fragment"><p><strong>Importance of Boundary Constraints</strong>: Natural cubic splines excel at controlling the function’s behavior near boundaries, mitigating overfitting and improving interpretability in regions with sparse data.<br>
</p></li>
<li class="fragment"><p><strong>Advantages Over Traditional Polynomials</strong>: Splines overcome the limitations of global polynomial fitting, such as excessive wiggliness or global influence of outliers, providing smoother, more interpretable fits that align closely with the data’s natural structure.</p></li>
<li class="fragment"><p><strong>Conclusion</strong>: Splines offer a superior method for non-linear modeling, combining flexibility, local adaptation, and smoothness, making them an indispensable tool in modern statistical analysis.</p></li>
</ul>
</div>
</section></section>
<section>
<section id="smoothing-splines" class="title-slide slide level1 center" data-background-color="#cfb991">
<h1>Smoothing Splines</h1>

</section>
<section id="smoothing-splines-adding-mathematical-rigor" class="slide level2 center">
<h2>Smoothing Splines: Adding Mathematical Rigor</h2>
<div style="font-size: 80%;">
<p>Smoothing splines are an extension of regression splines but arise in a different context. They are derived by minimizing a residual sum of squares criterion subject to a penalty for roughness, balancing data fidelity and smoothness.</p>
<p>The optimization criterion for fitting a smooth function <span class="math inline">\(g(x)\)</span> to data is given by:</p>
<p><span class="math display">\[
\text{minimize}_{g \in S}  \sum_{i=1}^n \left(y_i - g(x_i)\right)^2 + \lambda \int \left( g''(t) \right)^2 dt
\]</span></p>
<p><strong>Key Components</strong>:</p>
<ul>
<li class="fragment"><p><strong>Residual Sum of Squares (RSS)</strong>: The first term, <span class="math inline">\(\sum_{i=1}^n \left(y_i - g(x_i)\right)^2\)</span>, ensures that the function <span class="math inline">\(g(x)\)</span> fits the observed data points <span class="math inline">\((x_i, y_i)\)</span> closely.</p></li>
<li class="fragment"><p><strong>Roughness Penalty</strong>: The second term, <span class="math inline">\(\lambda \int \left( g''(t) \right)^2 dt\)</span>, penalizes the curvature of <span class="math inline">\(g(x)\)</span> by integrating the square of its second derivative. This term controls how “wiggly” the function is and enforces smoothness.</p></li>
<li class="fragment"><p><strong>Tuning Parameter</strong> <span class="math inline">\(\lambda\)</span>: The parameter <span class="math inline">\(\lambda \geq 0\)</span> determines the tradeoff between fit and smoothness:</p>
<ul>
<li class="fragment"><p>When <span class="math inline">\(\lambda = 0\)</span>: The penalty vanishes, and the function <span class="math inline">\(g(x)\)</span> becomes fully flexible, interpolating all data points.</p></li>
<li class="fragment"><p>As <span class="math inline">\(\lambda \to \infty\)</span>: The penalty dominates, and <span class="math inline">\(g(x)\)</span> becomes increasingly smooth, eventually reducing to a simple linear function.</p></li>
</ul></li>
</ul>
<div class="fragment">
<p><strong>Intuition:</strong> Smoothing splines allow for flexible, smooth fits that adapt to the structure of the data while avoiding excessive overfitting. By tuning <span class="math inline">\(\lambda\)</span>, analysts can strike a balance between capturing meaningful patterns and maintaining a smooth, interpretable curve.</p>
</div>
</div>
</section>
<section id="smoothing-splines-1" class="slide level2 center">
<h2>Smoothing Splines</h2>
<div style="font-size: 80%;">
<p>Smoothing splines yield a <strong>natural cubic spline</strong> solution with a knot at every unique value of <span class="math inline">\(x_i\)</span>. Rather than choosing specific knot locations, practitioners select a single tuning parameter <span class="math inline">\(\lambda\)</span>, which balances <strong>data fidelity</strong> and <strong>smoothness</strong> through the roughness penalty.</p>
<ul>
<li class="fragment"><p><strong>Automatic Knot Placement</strong>: By placing a knot at each unique <span class="math inline">\(x_i\)</span>, smoothing splines avoid the need to manually choose knot positions. The smoothness parameter <span class="math inline">\(\lambda\)</span> becomes the key lever for controlling model complexity.</p></li>
<li class="fragment"><p><strong>Smoother Matrix</strong>: The fitted values can be written as</p></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
    \hat{g}_\lambda = \mathbf{S}_\lambda\,\mathbf{y},
\]</span></p>
<p>where <span class="math inline">\(\mathbf{S}_\lambda\)</span> is an <span class="math inline">\(n \times n\)</span> matrix determined by the locations of the <span class="math inline">\(x_i\)</span> and the penalty <span class="math inline">\(\lambda\)</span>.</p>
</div>
<ul>
<li class="fragment"><strong>Effective Degrees of Freedom</strong>: The complexity of the smoothing spline is measured by the <em>effective degrees of freedom</em>, computed as</li>
</ul>
<div class="fragment">
<p><span class="math display">\[
    \text{df}_\lambda = \sum_{i=1}^n \{\mathbf{S}_\lambda\}_{ii},
\]</span></p>
<p>i.e., the trace of the smoother matrix. A larger trace indicates a more flexible fit, while a smaller trace corresponds to a smoother, less flexible curve.</p>
</div>
</div>
</section>
<section id="smoothing-splines-choosing-lambda" class="slide level2 center">
<h2>Smoothing Splines — Choosing <span class="math inline">\(\lambda\)</span></h2>
<div style="font-size: 80%;">
<p><strong>Specifying</strong> <span class="math inline">\(\text{df}\)</span> Instead of <span class="math inline">\(\lambda\)</span></p>
<ul>
<li class="fragment">A key advantage of smoothing splines is the option to specify the <em>effective degrees of freedom (</em><span class="math inline">\(\text{df}\)</span>) directly, rather than choosing <span class="math inline">\(\lambda\)</span> outright. This allows you to control the spline’s flexibility (or smoothness) in more intuitive terms.</li>
</ul>
<div class="fragment">
<p><strong>LOOCV</strong></p>
<ul>
<li class="fragment">Alternatively, <span class="math inline">\(\lambda\)</span> can be selected to minimize the leave-one-out (LOO) cross-validation error, given by</li>
</ul>
</div>
<div class="fragment">
<p><span class="math display">\[
\text{RSS}_{\text{cv}}(\lambda)
      = \sum_{i=1}^n \Bigl( y_i - \hat{g}_\lambda^{(-i)}(x_i) \Bigr)^2
      = \sum_{i=1}^n \left[\frac{y_i - \hat{g}_\lambda(x_i)}{1 - \{\mathbf{S}_\lambda\}_{ii}} \right]^2,
\]</span></p>
<p>where <span class="math inline">\(\hat{g}_\lambda^{(-i)}\)</span> denotes the fitted function obtained by leaving out the <span class="math inline">\(i\)</span>-th observation, and <span class="math inline">\(\mathbf{S}_\lambda\)</span> is the smoother matrix.</p>
<p>Whether you fix the degrees of freedom directly or optimize <span class="math inline">\(\lambda\)</span> via cross-validation, the goal is to strike a balance between fidelity to the data and smoothness of the spline.</p>
</div>
</div>
</section>
<section id="smoothing-splines-specifying-degrees-of-freedom" class="slide level2 center">
<h2>Smoothing Splines: Specifying Degrees of Freedom</h2>
<div style="font-size: 80%;">
<ol type="1">
<li class="fragment"><strong>Effective Degrees of Freedom (df)</strong></li>
</ol>
<ul>
<li class="fragment"><p>Instead of selecting <span class="math inline">\(\lambda\)</span> directly, we choose an equivalent “degrees of freedom” value, <span class="math inline">\(\text{df}_\lambda\)</span>.</p></li>
<li class="fragment"><p>The relationship between <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\text{df}\)</span> is such that increasing <span class="math inline">\(\lambda\)</span> (stronger penalty) lowers <span class="math inline">\(\text{df}\)</span>, leading to a smoother (less flexible) spline.</p></li>
</ul>
<ol start="2" type="1">
<li class="fragment"><strong>Advantages</strong></li>
</ol>
<ul>
<li class="fragment"><p><strong>Intuitive Interpretation</strong>: <span class="math inline">\(\text{df}\)</span> tells us how many “parameters” (roughly) our model is using, making it easier to grasp complexity.</p></li>
<li class="fragment"><p><strong>Direct Control</strong>: Analysts may already have an idea of how flexible their model needs to be, and can set <span class="math inline">\(\text{df}\)</span> accordingly.</p></li>
</ul>
<ol start="3" type="1">
<li class="fragment"><strong>Practical Tip</strong></li>
</ol>
<ul>
<li class="fragment">Empirically, one might try a range of df values (e.g., 4, 5, 6, …) and pick the one that balances interpretability and fit (potentially guided by an information criterion or cross-validation).</li>
</ul>
</div>
</section>
<section id="smoothing-splines-loocv-to-specify-lambda" class="slide level2 center">
<h2>Smoothing Splines: LOOCV to Specify <span class="math inline">\(\lambda\)</span></h2>
<div style="font-size: 80%;">
<div class="columns">
<div class="column" style="justify-content: center; align-items: center;">
<ol type="1">
<li class="fragment">We can use <strong>Cross-validation</strong> to choose <span class="math inline">\(\lambda\)</span>.</li>
</ol>
<ul>
<li class="fragment">For each candidate <span class="math inline">\(\lambda\)</span>, we leave out one data point at a time, fit the spline, and measure the prediction error on the held-out point.</li>
</ul>
<ol start="2" type="1">
<li class="fragment"><strong>Mathematical Form</strong></li>
</ol>
<div class="fragment">
<p><span class="math display">\[
     \text{RSS}_{\text{cv}}(\lambda)
       = \sum_{i=1}^n \left(y_i - \hat{g}_\lambda^{(-i)}(x_i)\right)^2,
\]</span></p>
</div>
<ul>
<li class="fragment"><p>where <span class="math inline">\(\hat{g}_\lambda^{(-i)}\)</span> denotes the spline fitted without the <span class="math inline">\(i\)</span>-th data point.</p></li>
<li class="fragment"><p>In practice, this can be computed more efficiently via the influence matrix <span class="math inline">\(\mathbf{S}_\lambda\)</span>:</p></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
       \text{RSS}_{\text{cv}}(\lambda)
         = \sum_{i=1}^n \left[\frac{y_i - \hat{g}_\lambda(x_i)}{1 - \{\mathbf{S}_\lambda\}_{ii}} \right]^2.
\]</span></p>
</div>
</div><div class="column" style="justify-content: center; align-items: center;">
<ol start="3" type="1">
<li class="fragment"><strong>Advantages</strong></li>
</ol>
<ul>
<li class="fragment"><p><strong>Data-Driven</strong>: No need to guess <span class="math inline">\(\text{df}\)</span> or <span class="math inline">\(\lambda\)</span>; we let cross-validation find the best trade-off.</p></li>
<li class="fragment"><p><strong>Robust</strong>: Tends to choose a value that generalizes well to new data.</p></li>
</ul>
<ol start="4" type="1">
<li class="fragment"><strong>Practical Tip</strong></li>
</ol>
<ul>
<li class="fragment">Evaluate <span class="math inline">\(\text{RSS}_{\text{cv}}\)</span> for a grid of <span class="math inline">\(\lambda\)</span> values (e.g., <span class="math inline">\(\lambda \in \{0.01, 0.1, 1, 10\}\)</span>) and pick the one that minimizes the cross-validation error.</li>
</ul>
</div></div>
</div>
</section>
<section id="smoothing-spline-degrees-of-freedom" class="slide level2 center">
<h2>Smoothing Spline: Degrees of Freedom</h2>

<img data-src="figs/7_8-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:65.0%"></section></section>
<section>
<section id="local-regression" class="title-slide slide level1 center" data-background-color="#cfb991">
<h1>Local Regression</h1>

</section>
<section id="local-regression-1" class="slide level2 center">
<h2>Local Regression</h2>
<div style="font-size: 75%;">
<p>Local regression is similar to splines, but differs in an important way. The regions are allowed to overlap, and indeed they do so in a very smooth way.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/7_9-1.png" class="quarto-figure quarto-figure-center" style="width:65.0%"></p>
</figure>
</div>
</div>
</div>
<p>With a sliding weight function, we fit separate linear fits over the range of <span class="math inline">\(X\)</span> by weighted least squares.</p>
<p><br></p>
<center>
<strong>It is a smart way to fit non-linear functions by fitting local linear functions on the data!</strong>
</center>
<p><br></p>
</div>
</section></section>
<section>
<section id="generalized-additive-models" class="title-slide slide level1 center" data-background-color="#cfb991">
<h1>Generalized Additive Models</h1>

</section>
<section id="generalized-additive-models-1" class="slide level2 center">
<h2>Generalized Additive Models</h2>
<p>Generalized additive models (GAMs) allow us to extend the methods covered in this lecture to deal with multiple predictors.</p>
<p>GAMs allows for flexible nonlinearities in several variables, but retains the additive structure of linear models.</p>
<p><span class="math display">\[
y_i = \beta_0 + f_1(x_{i1}) + f_2(x_{i2}) + \cdots + f_p(x_{ip}) + \epsilon_i.
\]</span></p>

<img data-src="figs/7_11-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:65.0%"></section>
<section id="gam-details" class="slide level2 center">
<h2>GAM Details</h2>
<ul>
<li class="fragment"><p>Can fit a GAM simply using, e.g., natural splines:</p></li>
<li class="fragment"><p>Coefficients are not that interesting; fitted functions are.</p></li>
</ul>
<!---
The previous plot was produced using `plot.gam`.
--->
<ul>
<li class="fragment"><p>Can mix terms — some linear, some nonlinear — and compare models with ANOVA.</p></li>
<li class="fragment"><p>Can use smoothing splines or local regression as well:</p>
<ul>
<li class="fragment">GAMs are additive, although low-order interactions can be included in a natural way using, e.g., bivariate smoothers.</li>
</ul></li>
</ul>
</section>
<section id="gams-for-classification" class="slide level2 center">
<h2>GAMs for Classification</h2>
<p><span class="math display">\[
\log\left(\frac{p(X)}{1 - p(X)}\right) = \beta_0 + f_1(X_1) + f_2(X_2) + \cdots + f_p(X_p).
\]</span></p>

<!---
`gam(I(wage > 250) ~ year + s(age, df = 5) + education, family = binomial)`
--->
<img data-src="figs/7_13-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:65.0%"><p><br></p>
</section>
<section id="summary-2" class="slide level2 center">
<h2>Summary</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div style="font-size: 75%;">
<ul>
<li><p><strong>Polynomial Regression</strong></p>
<ul>
<li>Expands a linear model by adding powers of the predictor(s).<br>
</li>
<li>Simple to implement but can behave poorly at boundaries.</li>
</ul></li>
<li><p><strong>Step Functions</strong></p>
<ul>
<li>Partitions the predictor space into intervals; fits piecewise constant segments.<br>
</li>
<li>Highly interpretable but can appear “blocky” and requires choosing cutpoints.</li>
</ul></li>
<li><p><strong>Regression Splines</strong></p>
<ul>
<li>Uses piecewise polynomials, constrained to meet smoothly at knots.<br>
</li>
<li>Greater flexibility than polynomials or step functions, with continuity at knots.</li>
</ul></li>
<li><p><strong>Natural Cubic Splines</strong></p>
<ul>
<li>Enforce additional constraints for boundary behavior.<br>
</li>
<li>Allow more robust modeling without overfitting at the extremes.</li>
</ul></li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<div style="font-size: 75%;">
<ul>
<li><p><strong>Smoothing Splines</strong></p>
<ul>
<li>Automates knot selection (a knot at each data point); regularizes via a penalty on curvature.<br>
</li>
<li>Balances fidelity to data (<span class="math inline">\(\mathrm{RSS}\)</span>) and smoothness (<span class="math inline">\(\lambda\)</span>).<br>
</li>
<li><span class="math inline">\(\lambda\)</span> (or effective degrees of freedom) is chosen via cross-validation or by specifying df directly.</li>
</ul></li>
<li><p><strong>Local Regression</strong></p>
<ul>
<li>Fits a series of local linear models weighted by proximity to each target <span class="math inline">\(x\)</span>.</li>
<li>Useful for highly variable, nonlinear relationships.</li>
</ul></li>
<li><p><strong>Generalized Additive Models (GAMs)</strong></p>
<ul>
<li>Allows non-linear fits in multiple predictors yet maintains an additive structure.<br>
</li>
<li>Supports smooth terms (splines, local regression) combined with linear terms.<br>
</li>
</ul></li>
<li><p><strong>Bottom Line</strong></p>
<ul>
<li>By moving beyond a strictly linear framework—using polynomials, splines, or GAMs—analysts can more accurately capture complex patterns while retaining interpretability and control over model complexity.</li>
</ul></li>
</ul>
</div>
</div></div>
</section></section>
<section id="thank-you" class="title-slide slide level1 center" data-background-color="#cfb991">
<h1>Thank you!</h1>


</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p>Predictive Analytics</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":false},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: true,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1600,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>